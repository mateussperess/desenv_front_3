<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercício 01</title>
  </head>
  <body>
    <form id="form">
      <input id="nome" type="text" placeholder="Nome..." />
      <input id="nota1" type="number" placeholder="Nota 1..." />
      <input id="nota2" type="number" placeholder="Nota 2..." />
      <input type="submit" value="Cadastrar" type="submit" />
    </form>

    <input type="button" value="Maior média" onclick="calcularMaiorMedia()" />

    <div id="response"></div>
    <div id="mostrarMaiorMedia"></div>
    <div id="listaAlunos"> <h3> Lista de Alunos </h3></div>

    <script>
      const form = document.getElementById("form");
      const response = document.querySelector("#response");
      const listaAlunos = document.querySelector("#listaAlunos");
      const mostrarMaiorMedia = document.querySelector("#mostrarMaiorMedia");

      const lista = document.createElement("ul");
      listaAlunos.appendChild(lista);

      const alunos = [];

      form.addEventListener("submit", (e) => {
        response.textContent = "";
        e.preventDefault();

        let nome = document.getElementById("nome").value;
        let nota1 = document.getElementById("nota1").value;
        let nota2 = document.getElementById("nota2").value;

        let flagNome = true;
        let flagNota1 = true;
        let flagNota2 = true;

        if (nome === "") {
          let span = document.createElement("span");
          span.innerHTML = "O nome informado é inválido! <br>";
          span.style.color = "red";
          response.appendChild(span);
          flagNome = false;
        }

        if (nota1 === "" || isNaN(nota1) || nota1 < 0 || nota1 > 10) {
          let span = document.createElement("span");
          span.innerHTML = "A nota 1 informada é inválido! <br>";
          span.style.color = "red";
          response.appendChild(span);
          flagNota1 = false;
        }

        if (nota2 === "" || isNaN(nota2) || nota2 < 0 || nota2 > 10) {
          let span = document.createElement("span");
          span.innerHTML = "A nota 2 informada é inválido! <br>";
          span.style.color = "red";
          response.appendChild(span);
          flagNota2 = false;
        }

        if (flagNome && flagNota1 && flagNota2) {
          let novoAluno = {
            nome: nome,
            nota1: nota1,
            nota2: nota2,
          };

          alunos.push(novoAluno);

          let li = document.createElement("li");
          li.innerText = `Nome: ${novoAluno.nome} - Nota 1: ${novoAluno.nota1} - Nota 2: ${novoAluno.nota2}`;
          lista.appendChild(li);
        }
      });

      function calcularMaiorMedia() {
        let alunoMaiorMedia = {
          nomeAluno: "",
          mediaAluno: 0
        }        

        alunos.forEach(aluno => {
          let mediaAluno = (aluno.nota1 + aluno.nota2) / 2;
          if(mediaAluno > alunoMaiorMedia.mediaAluno) {
            alunoMaiorMedia = {
              nomeAluno: aluno.nome,
              mediaAluno: mediaAluno
            }
          }
        });

        let span = document.createElement("span");
        span.innerHTML = `Maior media: ${alunoMaiorMedia.nomeAluno} com a média: ${alunoMaiorMedia.mediaAluno}`;

        mostrarMaiorMedia.appendChild(span);
      }
    </script>
  </body>
</html>
